<#include "sidebar.html" />

<div class="row">
	<div class="container mt-4" style="font-size: 14px; line-height: 1.42857143;">
		<div class="card">
			<div class="card-body">
				<div class="row">
                    
                    <!-- Side Bar-->
                    <div class="col-md-3">
                        <@sidebar step="model" />
                        <div class="card bg-light mt-2">
                            <div class="card-body">
                                <div class="card-text">
									#i18n{pluginwizard.pluginwizard_modify_configuration_class.pageHelp}
								</div>
							</div>
						</div>
					</div>
                    <!-- End Side Bar-->

                    <!-- Card Content-->
					<div class="col-md-9">
						<form id="modify-configuration-class-form" class="form-horizontal" role="form" method="post" action="jsp/site/Portal.jsp">
							<fieldset>
								<legend>#i18n{pluginwizard.pluginwizard_modify_configuration_class.pageTitle}</legend>

								<#include "errors_handler.html" />
								<#include "infos_handler.html" />

								<input type="hidden" name="page" value="pluginwizard" /> 
								<input type="hidden" name="id" value="${business_class.id}" /> 
								<input type="hidden" name="business_class_id" value="${business_class.id}" />
								<input type="hidden" id="plugin_name" value="${plugin_model.pluginName}" /> 

								<!-- Group form task name -->
                                <div class="row mb-3 align-items-start">
                                    <label class="col-form-label col-md-2 text-end align-self-start">
                                        #i18n{pluginwizard.pluginwizard_modify_configuration_class.labelTaskName} * :
                                    </label>
                                    
                               <div class="col-md-10">
                                       <input type="text" id="taskName-input" name="workflow_task_name" class="form-control" value="${configuration.workflowTaskName!''}"
                                        	aria-describedby="taskName-help-message-div" size="30" maxlength=51 readonly/>
 
                                    	<div id="taskName-help-message-div" class="mt-2 text-muted" aria-live="polite" role="alert">
                                            <span id="taskNameSize-help-message-span" class="d-block"><i id="taskNameSize-help-icon"></i> 
                                                #i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesTaskNameSize}
                                            </span>
                                            <span id="taskName-help-message-span" class="d-block"><i id="taskName-help-icon"></i> 
                                                #i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesTaskName}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                
								<!-- Group form configuration class name -->
								 <div class="row mb-3 align-items-start">
                                    <label class="col-form-label col-md-2 text-end align-self-start">
                                    	#i18n{pluginwizard.pluginwizard_modify_configuration_class.labelConfigurationClass} * :
                                    </label>
									<div class="col-md-10">
                                       <input type="text" id="configurationClassName-input" name="business_class" class="form-control" value="${business_class.businessClass!''}"
                                                aria-describedby="configurationClassName-help-message-div" size="30" maxlength=51 readonly/>
 
                                    	<div id="configurationClassName-help-message-div" class="mt-2 text-muted" aria-live="polite" role="alert">
                                             <span id="configurationClassNameSize-help-message-span" class="d-block"><i id="configurationClassNameSize-help-icon"></i> 
                                                #i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesConfigurationClassSize}
                                            </span>
                                            <span id="configurationClassName-help-message-span" class="d-block"><i id="configurationClassName-help-icon"></i> 
                                                #i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesConfigurationClass}
                                            </span>
                                            <span id="configurationClassNamePattern-help-message-span" class="d-block"><i id="configurationClassNamePattern-help-icon"></i> 
                                                #i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesConfigurationClassPattern}
                                            </span>                            
                                        </div>
                                    </div>
								</div>

								<!-- Group form plural configuration class name -->
                                 <div class="row mb-3 align-items-start">
                                    <label class="col-form-label col-md-2 text-end align-self-start">
                                    	#i18n{pluginwizard.pluginwizard_modify_configuration_class.labelPluralConfigurationClass} * :
                                    </label>      
									<div class="col-md-10">    
										<input type="text" id="pluralConfigurationClassName-input"  name="plural_business_class" class="form-control" value="${business_class.pluralBusinessClass!''}" aria-describedby="pluralConfigurationClassName-help-message-div" size="30" maxlength=100/> 
										<div id="pluralConfigurationClassName-help-message-div" class="mt-2 text-muted">
											<span class="d-block">#i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesPluralConfigurationClass}</span>
											<span class="d-block"><i class="ti ti-info-circle mx-1"></i>#i18n{pluginwizard.pluginwizard_modify_configuration_class.infoPluralConfigurationClass}</span> 
										</div>    
									</div>    
								</div>

								<!-- Group form database table name -->
								<div class="row mb-3 align-items-start">
                                    <label class="col-form-label col-md-2 text-end align-self-start">
										#i18n{pluginwizard.pluginwizard_modify_configuration_class.labelConfigurationTableName} * : 
									</label>
									<div class="col-md-10">
										<input type="text" id="configurationTableName-input" name="business_table_name" class="form-control"
	                                   		value="workflow_task_" placeholder=#i18n{pluginwizard.pluginwizard_modify_configuration_class.placeholderConfigurationTableName} aria-describedby="configurationTableName-help-message-div" size="30" maxlength=64/> 
	                                    <div id="configurationTableName-help-message-div" class="mt-2 text-muted" aria-live="polite" role="alert">       
	                                    	<span id="configurationTableNameSize-help-message-span" class="d-block" ><i id="configurationTableNameSize-help-icon"></i>
	                                    		#i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesConfigurationTableNameSize} 
	                                    	</span>
	                                    	<span id="configurationTableNamePrefix-help-message-span" class="d-block" ><i id="configurationTableNamePrefix-help-icon"></i>
	                                    		#i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesConfigurationTableNamePrefix}
	                                    	</span>
	                                    	<span id="configurationTableName-help-message-span" class="d-block" ><i id="configurationTableName-help-icon"></i>
	                                    		#i18n{pluginwizard.pluginwizard_modify_configuration_class.helpRulesConfigurationTableName} 
	                                    	</span>
	                                	</div>
	                                </div>
								</div>
								
								<!-- Submit Buttons -->	
								<div class="form-group text-center">
									<button type="submit" name="action_modifyConfigurationClass"
										class="btn btn-primary" >
										#i18n{pluginwizard.pluginwizard_modidy_configuration_class.buttonModifyClass}
									</button>
									<button type="submit" name="action_validateAttributes"
										class="btn btn-secondary" >
										#i18n{pluginwizard.pluginwizard_modify_configuration_class.buttonBack}
									</button>
								</div>
							</fieldset>
						</form>
						<br /> <br />

						<!--Group form Add attributes -->
						<form class="form float-end" method="post" action="jsp/site/Portal.jsp">
							<input type="hidden" name="page" value="pluginwizard" /> 
							<input type="hidden" name="view" value="createAttribute" /> 
							<input type="hidden" name="business_class_id" value="${business_class.id}" />

							<button type="submit" class="btn btn-primary">
								<i class="ti ti-plus"></i>
								#i18n{pluginwizard.pluginwizard_modify_configuration_class.labelCreateAttribute}
							</button>
						</form>
						<h4>#i18n{pluginwizard.pluginwizard_modify_configuration_class.labelFielsetAttributes}</h4>
						
						<!-- Table of attributes -->
						<table class="table table-sm table-hover table-striped">

							<thead>
								<tr>
									<th>#i18n{pluginwizard.pluginwizard_modify_business_class.labelAttributeName}</th>
									<th>#i18n{pluginwizard.pluginwizard_modify_business_class.labelAttributeType}</th>
									<th>#i18n{pluginwizard.pluginwizard_modify_business_class.labelNotNull}</th>
									<#if (project_type?? && project_type == 'WORKFLOWTASK')>
										<th>#i18n{pluginwizard.pluginwizard_modify_business_class.labelWorkflowFormConfigRequired}</th>
										<th>#i18n{pluginwizard.pluginwizard_modify_business_class.labelWorkflowFormTaskRequired}</th>
									</#if>
									<th>#i18n{pluginwizard.pluginwizard_modify_business_class.labelMaxLength}</th>
									<th>#i18n{pluginwizard.pluginwizard_modify_business_class.labelAttributeAction}</th>
								</tr>
							</thead>

							<tbody>
								<tr>
									<td>#i18n{pluginwizard.pluginwizard_modify_business_class.labelId}</td>
									<td>#i18n{pluginwizard.pluginwizard_modify_business_class.labelPrimaryKey}</td>
									<td>#i18n{pluginwizard.pluginwizard_modify_business_class.labelAuto}</td>
										<#if (project_type?? && project_type == 'WORKFLOWTASK')>
										<td></td>
										<td></td>
									</#if>
									<td></td>
									<td></td>
								</tr>
								<#if attributes_list?? && attributes_list?size &gt; 0>		
									<#list attributes_list as attribute>
										<tr>
											<td>${attribute.attributeName}</td>
											<td>#i18n{pluginwizard.pluginwizard_attributes_types.${attribute.attributeTypeId}.description}</td>
											<td>
												<#if attribute.notNull> 
													<span class="badge bg-success"><i class="ti ti-check"></i></span> 
												</#if>
											</td>
											<#if (project_type?? && project_type == 'WORKFLOWTASK')>
												<td>
													<#if attribute.workflowFormConfigRequired> 
														<span class="badge bg-success"><i class="ti ti-check"></i></span> 
													</#if>
												</td>
												<td>
													<#if attribute.workflowFormTaskRequired> 
														<span class="badge bg-success"><i class="ti ti-check"></i></span> 
													</#if>
												</td>
											</#if>
											<td>
												<#if attribute.maxLength &gt; 0 >
													${attribute.maxLength}
												</#if>
											</td>
											<td>
												<a href="jsp/site/Portal.jsp?page=pluginwizard&view=modifyAttribute&attribute_id=${attribute.id}&business_class_id=${business_class.id}"
												   class="btn btn-primary btn-sm"
												   title="#i18n{pluginwizard.pluginwizard_modify_business_class.buttonModifyAttribute}">
												   <i class="ti ti-edit"></i>
												</a> 
												<a href="jsp/site/Portal.jsp?page=pluginwizard&action=confirmRemoveAttribute&attribute_id=${attribute.id}&business_class_id=${business_class.id}"
												   class="btn btn-danger btn-sm"
												   title="#i18n{pluginwizard.pluginwizard_modify_business_class.buttonRemoveAttribute}">
												   <i class="ti ti-trash"></i>
												</a>
											</td>
										</tr>
									</#list>
								</#if>
							</tbody>
						</table>
					</div>
					<!-- End Card Content-->
				</div>
			</div>
		</div>
	</div>
</div>

<script src='js/plugins/pluginwizard/validator.js'></script>
<script src='js/plugins/pluginwizard/pluralize.js'></script>
<script>
	updateFormFront('modify-configuration-class-form');
	autoFillConfigurationClassForm('modify-configuration-class-form');
	document.getElementById('modify-configuration-class-form').addEventListener('input', function(event){
		validationForm(event);
	});
</script>